10 REM MTS-70 MAIN MENU
20 CLS

21 REM SETUP CONNECTION
22 H$ = "192.168.1.10"  :REM UPDATE THIS TO YOUR SERVER IP
23 REM OPEN A TCP/IP SOCKET
24 OUT 236,16  	:REM ENABLE MODEL III BUS
25 OUT 31,1
26 OUT 31,1		:REM SOCKET COMMAND
27 OUT 31,1		:REM USE IPV4
28 OUT 31,1		:REM
29 GOSUB 5000
30 Y=INP(31)	:REM GET THE STATUS
31 IF Y <> 0 THEN PRINT "ERROR OPENING SOCKET": GOTO 1500
32 S=INP(31)	:REM STORE THE SOCKET FILE DESCRIPTOR
33 REM "THE SOCKET IS OPEN "
34 REM CONNECT TO THE SERVER
35 OUT 31,1
36 OUT 31,3	:REM CONNECT COMMAND
37 OUT 31,S
38 L = LEN(H$)
39 FOR T = 1 TO L
40 T$ = MID$(H$,T,1)
41 OUT 31,ASC(T$)
42 NEXT T
43 OUT 31,0	:REM NULL ENDS HOSTNAME
44 OUT 31,186   :REM PORT LSB for 5050
45 OUT 31,19    :REM PORT MSB for 5050
46 GOSUB 5000
47 Y = INP(31)
48 IF Y <> 0 THEN PRINT "ERROR CONNECTING TO GPT-4 SERVER": GOTO 1500
49 REM "YOU ARE CONNECTED TO GPT-4 SERVER"

50 PRINT "MTS-70"
55 PRINT
60 PRINT "1) Chat with MTS"
65 PRINT "2) Sing Happy Birthday"
70 PRINT "3) Marine Forecast"
72 PRINT "4) East End Events"
73 PRINT "5) Forest by the Sea: The RPG"
74 PRINT "6) Play a game of Go"
75 PRINT
80 INPUT "Choose 1, 2, 3, 4, 5 or 6: "; C$
84 M = 20
85 IF C$ = "1" THEN GOTO 200
90 IF C$ = "2" THEN GOTO 2000
100 IF C$ = "3" THEN GOTO 3300
105 IF C$ = "4" THEN GOTO 4000
106 IF C$ = "5" THEN GOTO 200
107 IF C$ = "6" THEN GOTO 199

109 IF C$ = "EXIT" THEN GOTO 1620
110 PRINT "Invalid choice. Try again."
120 GOTO 70

199 M = 5

200 REM SEND REQUEST FOR MTS CHAT
220 L = LEN(C$)
230 OUT 31,1
240 OUT 31,4
250 OUT 31,S
260 OUT 31,L+2:OUT 31,0: OUT 31,0: OUT 31,0
270 FOR T = 1 TO L:T$=MID$(C$,T,1):OUT 31,ASC(T$):NEXT T
280 OUT 31,13
290 OUT 31,10
300 GOSUB 5000
310 FOR T = 1 TO 5: Y=INP(31): NEXT T
320 REM "RECEIVING DATA FROM GPT-4..."

1290 REM MAIN LOOP
1299 IF C$ = "6" THEN PRINT "ENTER YOUR MOVE (TYPE 'MENU' TO QUIT)" ELSE PRINT "ENTER MESSAGE (TYPE 'MENU' TO QUIT)"
1310 INPUT Q$
1320 IF Q$ = "EXIT" THEN GOTO 1620
1325 IF Q$ = "MENU" THEN GOTO 50

1330 REM SEND MESSAGE
1340 PRINT
1350 L = LEN(Q$)
1360 OUT 31,1
1370 OUT 31,4
1380 OUT 31,S
1390 OUT 31,L+2:OUT 31,0: OUT 31,0: OUT 31,0
1400 FOR T = 1 TO L:T$=MID$(Q$,T,1):OUT 31,ASC(T$):NEXT T
1410 OUT 31,13
1420 OUT 31,10
1430 GOSUB 5000
1440 FOR T = 1 TO 5: Y=INP(31): NEXT T
1450 REM "RECEIVING DATA FROM GPT-4..."

1460 REM RECEIVE THE DATA
1470 OUT 31,1
1480 OUT 31,6
1490 OUT 31,S
1500 OUT 31,0	:REM USE BLOCKING FOR RESPONSE
1510 OUT 31,255:OUT 31,255:OUT 31,0:OUT 31,0		:REM DATA LENGTH REQUESTED
1520 GOSUB 5000
1530 Y = INP(31)
1540 IF Y <> 0 THEN PRINT "ERROR RECEIVING": GOTO 1620
1550 L1 = INP(31):L2 = INP(31):L3 = INP(31):L4 = INP(31)
1560 L = (L2 * 256) + L1
1570 FOR T = 1 TO L: Y=INP(31): PRINT CHR$(Y);: FOR W=1 TO M: NEXT W: NEXT T
1580 PRINT 
1590 PRINT
1600 REM "...DONE RECEIVING DATA FROM GPT-4"

1610 GOTO 1310

1620 REM CLOSE
1630 OUT 31,1
1640 OUT 31,8
1650 OUT 31,S
1660 GOSUB 5000
1670 Y = INP(31)
1680 IF Y = 0 THEN PRINT "THE SOCKET IS CLOSED" ELSE PRINT "ERROR ON CLOSE"
1690 GOTO 10

2000 REM SETUP SOUND DRIVER FOR 16K MEMORY
2010 FOR I=31232 TO 31268
2020 READ A
2030 POKE I,A
2040 NEXT I
2050 POKE 16526,0
2060 POKE 16527,122
2070 DATA 221,33,33,122,221,70,0,0,1
2080 DATA 37,122,221,70,1,62,1,211,255
2090 DATA 16,254,221,70,1,62,2,211,255
2100 DATA 16,254,13,194,11,122,30,10,0,201
2110 REM SOUND DRIVER SETUP COMPLETE

2120 REM HAPPY BIRTHDAY PROGRAM
2130 DIM N(25), P(25): REM ARRAYS FOR NOTES AND PAUSES
2140 REM DEFINE NOTES (SOUND VALUES)
2150 A=255: B=230: C=204: D=192: E=171
2160 F=152: G=144: H=135: I=127
2170 J=1: K=31266: REM K=31266 FOR 16K MEMORY
2180 REM STORE HAPPY BIRTHDAY NOTES IN ARRAY
2190 N(1)=A: N(2)=A: N(3)=B: N(4)=A: N(5)=D: N(6)=C
2200 N(7)=A: N(8)=A: N(9)=B: N(10)=A: N(11)=E: N(12)=D
2210 N(13)=A: N(14)=A: N(15)=I: N(16)=F: N(17)=D: N(18)=C: N(19)=B
2220 N(20)=G: N(21)=G: N(22)=F: N(23)=D: N(24)=E: N(25)=D
2230 REM STORE PAUSES IN ARRAY
2240 FOR J=1 TO 25: P(J)=20: NEXT J
2250 P(6)=60: P(12)=60: P(19)=60: P(25)=60
2260 REM PLAY THE TUNE
2270 V=25
2280 FOR J=1 TO V
2290 POKE K,N(J): X=USR(0)
2300 FOR W=1 TO P(J): NEXT W
2310 NEXT J
2320 REM "END OF TUNE."
2330 GOTO 50

3300 REM SEND REQUEST FOR MARINE FORECAST
3310 Q$ = "3"
3320 L = LEN(Q$)
3330 OUT 31,1
3340 OUT 31,4
3350 OUT 31,S
3360 OUT 31,L+2:OUT 31,0: OUT 31,0: OUT 31,0
3370 FOR T = 1 TO L:T$=MID$(Q$,T,1):OUT 31,ASC(T$):NEXT T
3380 OUT 31,13
3390 OUT 31,10
3400 GOSUB 5000
3410 FOR T = 1 TO 5: Y=INP(31): NEXT T
3420 REM "RECEIVING DATA FROM GPT-4..."

3430 REM RECEIVE THE DATA
3440 OUT 31,1
3450 OUT 31,6
3460 OUT 31,S
3470 OUT 31,0	:REM USE BLOCKING FOR RESPONSE
3480 OUT 31,255:OUT 31,255:OUT 31,0:OUT 31,0		:REM DATA LENGTH REQUESTED
3490 GOSUB 5000
3500 Y = INP(31)
3510 IF Y <> 0 THEN PRINT "ERROR RECEIVING": GOTO 1620
3520 L1 = INP(31):L2 = INP(31):L3 = INP(31):L4 = INP(31)
3530 L = (L2 * 256) + L1
3540 FOR T = 1 TO L: Y=INP(31): PRINT CHR$(Y);: FOR W=1 TO 10: NEXT W: NEXT T
3550 PRINT 
3560 PRINT
3570 REM "...DONE RECEIVING DATA FROM GPT-4"

3580 REM MAIN LOOP
3590 PRINT "TYPE 'MENU' TO EXIT)"
3600 INPUT Q$
3610 IF Q$ = "MENU" THEN GOTO 50
3620 IF Q$ = "EXIT" THEN GOTO 1620

4000 REM SEND REQUEST FOR EAST END EVENTS
4010 Q$ = "4"
4020 L = LEN(Q$)
4030 OUT 31,1
4040 OUT 31,4
4050 OUT 31,S
4060 OUT 31,L+2:OUT 31,0: OUT 31,0: OUT 31,0
4070 FOR T = 1 TO L:T$=MID$(Q$,T,1):OUT 31,ASC(T$):NEXT T
4080 OUT 31,13
4090 OUT 31,10
4100 GOSUB 5000
4110 FOR T = 1 TO 5: Y=INP(31): NEXT T
4120 REM "RECEIVING DATA FROM GPT-4..."

4130 REM RECEIVE THE DATA
4140 OUT 31,1
4150 OUT 31,6
4160 OUT 31,S
4170 OUT 31,0	:REM USE BLOCKING FOR RESPONSE
4180 OUT 31,255:OUT 31,255:OUT 31,0:OUT 31,0		:REM DATA LENGTH REQUESTED
4190 GOSUB 5000
4200 Y = INP(31)
4210 IF Y <> 0 THEN PRINT "ERROR RECEIVING": GOTO 1620
4220 L1 = INP(31):L2 = INP(31):L3 = INP(31):L4 = INP(31)
4230 L = (L2 * 256) + L1
4240 FOR T = 1 TO L: Y=INP(31): PRINT CHR$(Y);: FOR W=1 TO 10: NEXT W: NEXT T
4250 PRINT 
4260 PRINT
4270 REM "...DONE RECEIVING DATA FROM GPT-4"

4280 REM MAIN LOOP
4290 PRINT "TYPE 'MENU' TO QUIT)"
4300 INPUT Q$
4310 IF Q$ = "MENU" THEN GOTO 50
4320 IF Q$ = "EXIT" THEN GOTO 1620

5000 IF PEEK(293) = 73 THEN GOTO 5030
5010 IF (PEEK(14304) AND 32) <> 0 THEN GOTO 5010
5020 RETURN
5030 IF (INP(224) AND 8) <> 0 THEN GOTO 5030
5040 RETURN